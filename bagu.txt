## Bagu-Service 实现逻辑分析

### 1. 整体架构

Bagu-Service 是一个基于Spring Boot的微服务，主要提供八股文题目相关的功能。它采用了典型的分层架构：

- Controller层：处理HTTP请求
- Service层：实现业务逻辑
- Mapper层：数据访问层
- POJO/DTO/VO：数据传输对象

### 2. 核心功能模块

#### 2.1 题目管理模块 (Question)

- **创建题目**：支持管理员创建题目，包含标题、内容、标签、答案等字段
- **更新题目**：允许修改题目信息
- **删除题目**：逻辑删除，并同时解除与题库的关联
- **查询题目**：支持分页查询、关键词搜索、标签筛选等功能
- **点赞/收藏**：用户可以对题目进行点赞和收藏操作
- **浏览量统计**：自动增加题目浏览量

#### 2.2 题库管理模块 (QuestionBank)

- **创建题库**：支持管理员创建题库，包含标题、描述、图片等信息
- **更新题库**：允许修改题库信息
- **删除题库**：逻辑删除，并同时解除与题目的关联
- **查询题库**：支持分页查询题库列表

#### 2.3 题库题目关联模块 (QuestionBankQuestion)

- **添加题目到题库**：支持单个或批量将题目添加到题库
- **从题库移除题目**：可以从题库中移除指定题目
- **查询题库下的题目**：可以获取指定题库下的所有题目

### 3. 技术特点

#### 3.1 数据库设计

- 使用MySQL作为主数据库
- 采用逻辑删除策略（isDelete字段）
- 通过关联表实现题库与题目的多对多关系
- 单独的点赞表和收藏表记录用户行为

#### 3.2 微服务集成

- 通过Feign Client调用user-service获取用户信息
- 使用Nacos进行服务注册与发现
- 集成Sa-Token实现权限控制和跨服务Token共享
- 使用Redis存储用户会话信息

#### 3.3 性能优化

- 批量获取用户信息，减少远程调用次数
- 使用MyBatis Plus提高数据库操作效率
- 通过索引优化数据库查询性能

#### 3.4 安全机制

- 使用Sa-Token实现基于角色的权限控制
- 对敏感操作（增删改）限制为管理员角色
- 参数校验和异常处理机制

### 4. 主要业务流程

#### 4.1 创建题目流程

1. 管理员发起创建题目请求
2. 后端校验参数合法性
3. 将题目信息保存到数据库
4. 返回题目ID

#### 4.2 点赞/收藏流程

1. 用户发起点赞/收藏请求
2. 检查题目和用户是否存在
3. 查询用户是否已点赞/收藏
4. 若已存在则取消，否则添加记录
5. 更新题目的点赞/收藏计数

#### 4.3 查询题目流程

1. 用户发起查询请求（分页/搜索）
2. 构建查询条件（关键词、标签、题库等）
3. 从数据库查询符合条件的题目
4. 批量获取题目作者信息
5. 返回分页结果


  