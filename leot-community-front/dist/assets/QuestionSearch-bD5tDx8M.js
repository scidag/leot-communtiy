import{d as P,Y as D,u as E,a as J,T as H,b as O,r as V,v as X,R as Y,c as g,e as r,o as a,g as n,f as l,w as p,U as _,V as h,i as u,G as b,x as q,m as C,z as T,L as $,X as j,_ as A}from"./index-fmth1Foz.js";import{u as W}from"./bagu-CFlVxt4r.js";import{T as Z}from"./TechHeader-D3cWMTWR.js";import{G as K}from"./GlassCard-B7OKtasV.js";import{Q as ee}from"./QuestionCard-C4fR_9VW.js";import"./question-DUAdpd1i.js";const te={class:"tech-page question-search"},se={class:"question-search__content"},le={class:"filter-row"},oe={class:"filter-item"},ae={class:"filter-item"},ne={class:"filter-item"},re={class:"question-search__results"},ue={class:"results-header"},ie={key:0,class:"results-keyword"},de={class:"gradient-text"},ce={class:"results-count"},pe={key:0,class:"question-list"},me={key:1,class:"empty-state"},ge={key:2,class:"question-list"},_e={key:3,class:"question-search__pagination"},he=P({__name:"QuestionSearch",setup(ve){const v=D(),x=E(),d=W(),w=J(),{questions:S,banks:B,loading:z,total:k}=H(d),s=O({keyword:"",tags:[],questionBankId:void 0,sortField:"createTime",sortOrder:"desc",current:1,pageSize:10}),m=V(null),F=V(["Java","Spring","MySQL","Redis","JVM","并发","网络","算法","设计模式","微服务"]);X(()=>{v.query.keyword&&(s.keyword=v.query.keyword),d.fetchBanks({current:1,pageSize:100}),c()}),Y(()=>v.query.keyword,o=>{o&&(s.keyword=o,s.current=1,c())});const c=()=>{d.searchQuestions(s)},N=o=>{s.keyword=o,s.current=1,c()},y=()=>{s.current=1,c()},Q=o=>{s.current=o,m.value=null,c()},U=o=>{m.value=m.value===o?null:o},I=o=>{if(!w.token){x.push("/login");return}d.toggleThumb(o)},R=o=>{if(!w.token){x.push("/login");return}d.toggleFavour(o)};return(o,e)=>{const i=g("el-option"),f=g("el-select"),G=g("el-icon"),L=g("el-pagination");return a(),r("div",te,[n(Z,{title:"搜索题目",subtitle:"快速找到你想学习的内容","show-search":!0,"search-placeholder":"输入关键词搜索...",onSearch:N}),l("div",se,[n(K,{class:"question-search__filters",padding:"20px"},{default:p(()=>[l("div",le,[l("div",oe,[e[4]||(e[4]=l("label",null,"题库筛选",-1)),n(f,{modelValue:s.questionBankId,"onUpdate:modelValue":e[0]||(e[0]=t=>s.questionBankId=t),placeholder:"选择题库",clearable:"",onChange:y},{default:p(()=>[(a(!0),r(_,null,h(u(B),t=>(a(),b(i,{key:t.id,label:t.title,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",ae,[e[5]||(e[5]=l("label",null,"标签筛选",-1)),n(f,{modelValue:s.tags,"onUpdate:modelValue":e[1]||(e[1]=t=>s.tags=t),placeholder:"选择标签",multiple:"",clearable:"",onChange:y},{default:p(()=>[(a(!0),r(_,null,h(F.value,t=>(a(),b(i,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),l("div",ne,[e[6]||(e[6]=l("label",null,"排序方式",-1)),n(f,{modelValue:s.sortField,"onUpdate:modelValue":e[2]||(e[2]=t=>s.sortField=t),onChange:y},{default:p(()=>[n(i,{label:"最新发布",value:"createTime"}),n(i,{label:"最多浏览",value:"viewNum"}),n(i,{label:"最多点赞",value:"thumbNum"}),n(i,{label:"最多收藏",value:"favourNum"})]),_:1},8,["modelValue"])])])]),_:1}),l("div",re,[l("div",ue,[s.keyword?(a(),r("span",ie,[e[7]||(e[7]=C(' 搜索 "',-1)),l("span",de,T(s.keyword),1),e[8]||(e[8]=C('" 的结果 ',-1))])):q("",!0),l("span",ce,"共 "+T(u(k))+" 条结果",1)]),u(z)?(a(),r("div",pe,[(a(),r(_,null,h(5,t=>l("div",{key:t,class:"skeleton-question"},[...e[9]||(e[9]=[l("div",{class:"skeleton",style:{height:"24px",width:"70%","margin-bottom":"12px"}},null,-1),l("div",{class:"skeleton",style:{height:"20px",width:"40%","margin-bottom":"16px"}},null,-1),l("div",{class:"skeleton",style:{height:"20px",width:"30%"}},null,-1)])])),64))])):u(S).length===0?(a(),r("div",me,[n(G,{size:64},{default:p(()=>[n(u($))]),_:1}),e[10]||(e[10]=l("p",null,"未找到相关题目",-1)),e[11]||(e[11]=l("p",{class:"empty-hint"},"试试其他关键词或筛选条件",-1))])):(a(),r("div",ge,[(a(!0),r(_,null,h(u(S),(t,M)=>(a(),b(ee,{key:t.id,question:t,expanded:m.value===t.id,class:"animate-fade-in-up",style:j({animationDelay:`${M*.05}s`}),onClick:U,onThumb:I,onFavour:R},null,8,["question","expanded","style"]))),128))])),u(k)>s.pageSize?(a(),r("div",_e,[n(L,{"current-page":s.current,"onUpdate:currentPage":e[3]||(e[3]=t=>s.current=t),"page-size":s.pageSize,total:u(k),layout:"prev, pager, next",background:"",onCurrentChange:Q},null,8,["current-page","page-size","total"])])):q("",!0)])])])}}}),Se=A(he,[["__scopeId","data-v-9440de27"]]);export{Se as default};
